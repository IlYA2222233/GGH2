-- ============================================
-- GGH UNIVERSAL CHEAT DETECTOR v3.0
-- –†–∞–±–æ—Ç–∞–µ—Ç –≤–æ –í–°–ï–• –∏–≥—Ä–∞—Ö Roblox
-- ============================================

-- –°–µ—Ä–≤–∏—Å—ã
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local Workspace = game:GetService("Workspace")
local TweenService = game:GetService("TweenService")
local VirtualInputManager = game:GetService("VirtualInputManager")

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ LocalPlayer
if not LocalPlayer then
    repeat task.wait(0.1) until Players.LocalPlayer
    LocalPlayer = Players.LocalPlayer
end

-- ============================================
-- 1. –°–ò–°–¢–ï–ú–ê –î–ï–¢–ï–ö–¶–ò–ò –ß–ò–¢–ê
-- ============================================

local CheatDetector = {
    ActiveCheaters = {},
    SuspiciousActivities = {},
    DetectionLogs = {},
    PlayerHistory = {},
    Settings = {
        SpeedThreshold = 250, -- Studs/—Å–µ–∫
        FlightHeight = 100, -- Studs
        TeleportDistance = 200, -- Studs –∑–∞ –∫–∞–¥—Ä
        NoclipDetection = true,
        AntiAimDetection = true,
        CheckInterval = 0.2 -- —Å–µ–∫—É–Ω–¥—ã
    }
}

-- –î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
function CheatDetector:DetectSpeed(player)
    if not player.Character then return false, nil end
    
    local humanoid = player.Character:FindFirstChild("Humanoid")
    local rootPart = player.Character:FindFirstChild("HumanoidRootPart") or player.Character:FindFirstChild("Torso") or player.Character:FindFirstChild("UpperTorso")
    
    if not rootPart then return false, nil end
    
    local velocity = rootPart.Velocity
    local speed = velocity.Magnitude
    
    -- –§–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤ Roblox
    if speed > CheatDetector.Settings.SpeedThreshold then
        return true, string.format("‚ö° –ê–Ω–æ–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å: %.0f studs/—Å–µ–∫", speed)
    end
    
    return false, nil
end

-- –î–µ—Ç–µ–∫—Ü–∏—è –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ–≥–æ –ø–æ–ª–µ—Ç–∞
function CheatDetector:DetectFlight(player)
    if not player.Character then return false, nil end
    
    local humanoid = player.Character:FindFirstChild("Humanoid")
    local rootPart = player.Character:FindFirstChild("HumanoidRootPart") or player.Character:FindFirstChild("Torso")
    
    if not rootPart or not humanoid then return false, nil end
    
    local height = rootPart.Position.Y
    local floorMaterial = humanoid.FloorMaterial
    local seatPart = humanoid.SeatPart
    
    -- –ò–≥—Ä–æ–∫ –≤—ã—Å–æ–∫–æ, –Ω–µ –Ω–∞ –∑–µ–º–ª–µ –∏ –Ω–µ –≤ —Å–∏–¥–µ–Ω—å–µ
    if height > CheatDetector.Settings.FlightHeight 
        and floorMaterial == Enum.Material.Air 
        and not seatPart 
        and humanoid:GetState() ~= Enum.HumanoidStateType.Freefall then
        
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–∞–¥–∞–µ—Ç –ª–∏ –æ–Ω
        local velocityY = rootPart.Velocity.Y
        if math.abs(velocityY) < 10 then -- –ù–µ –ø–∞–¥–∞–µ—Ç, –¥–µ—Ä–∂–∏—Ç—Å—è –≤ –≤–æ–∑–¥—É—Ö–µ
            return true, string.format("üïäÔ∏è –ù–µ–∑–∞–∫–æ–Ω–Ω—ã–π –ø–æ–ª–µ—Ç –Ω–∞ –≤—ã—Å–æ—Ç–µ %.0f studs", height)
        end
    end
    
    return false, nil
end

-- –î–µ—Ç–µ–∫—Ü–∏—è —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏–∏
CheatDetector.LastPositions = {}
function CheatDetector:DetectTeleport(player)
    if not player.Character then return false, nil end
    
    local rootPart = player.Character:FindFirstChild("HumanoidRootPart") or player.Character:FindFirstChild("Torso")
    if not rootPart then return false, nil end
    
    local currentPos = rootPart.Position
    local lastPos = CheatDetector.LastPositions[player]
    
    CheatDetector.LastPositions[player] = currentPos
    
    if lastPos then
        local distance = (currentPos - lastPos).Magnitude
        
        -- –§–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
        if distance > CheatDetector.Settings.TeleportDistance then
            return true, string.format("üåÄ –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è: %.0f studs –∑–∞ –∫–∞–¥—Ä", distance)
        end
    end
    
    return false, nil
end

-- –î–µ—Ç–µ–∫—Ü–∏—è Noclip
function CheatDetector:DetectNoclip(player)
    if not player.Character or not CheatDetector.Settings.NoclipDetection then 
        return false, nil 
    end
    
    local collisionParts = 0
    local totalParts = 0
    
    for _, part in pairs(player.Character:GetChildren()) do
        if part:IsA("BasePart") then
            totalParts = totalParts + 1
            if part.CanCollide == false then
                collisionParts = collisionParts + 1
            end
        end
    end
    
    -- –ï—Å–ª–∏ –≤—Å–µ —á–∞—Å—Ç–∏ –±–µ–∑ –∫–æ–ª–ª–∏–∑–∏–π
    if totalParts > 0 and collisionParts == totalParts then
        return true, "üëª Noclip –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω"
    end
    
    return false, nil
end

-- –î–µ—Ç–µ–∫—Ü–∏—è Anti-Aim
function CheatDetector:DetectAntiAim(player)
    if not player.Character or not CheatDetector.Settings.AntiAimDetection then 
        return false, nil 
    end
    
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if not humanoid then return false, nil end
    
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–∞—â–µ–Ω–∏—è
    local rootPart = player.Character:FindFirstChild("HumanoidRootPart")
    if rootPart then
        local angularVelocity = rootPart.AssemblyAngularVelocity.Magnitude
        
        -- –°–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ
        if angularVelocity > 50 then
            return true, string.format("üåÄ –ê–Ω–æ–º–∞–ª—å–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ: %.0f rad/—Å–µ–∫", angularVelocity)
        end
    end
    
    return false, nil
end

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏
function CheatDetector:CheckPlayer(player)
    if player == LocalPlayer then return end -- –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ–±—è
    
    local detections = {}
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–∏–¥—ã —á–∏—Ç–∞
    local speedDetected, speedReason = self:DetectSpeed(player)
    if speedDetected then table.insert(detections, speedReason) end
    
    local flightDetected, flightReason = self:DetectFlight(player)
    if flightDetected then table.insert(detections, flightReason) end
    
    local teleportDetected, teleportReason = self:DetectTeleport(player)
    if teleportDetected then table.insert(detections, teleportReason) end
    
    local noclipDetected, noclipReason = self:DetectNoclip(player)
    if noclipDetected then table.insert(detections, noclipReason) end
    
    local antiAimDetected, antiAimReason = self:DetectAntiAim(player)
    if antiAimDetected then table.insert(detections, antiAimReason) end
    
    -- –ï—Å–ª–∏ –µ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
    if #detections > 0 then
        local detectionString = table.concat(detections, " | ")
        
        -- –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        if not self.PlayerHistory[player] then
            self.PlayerHistory[player] = {}
        end
        
        table.insert(self.PlayerHistory[player], {
            Time = os.time(),
            Reason = detectionString
        })
        
        -- –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ —á–∏—Ç–µ—Ä–∞
        if not self.ActiveCheaters[player] then
            self.ActiveCheaters[player] = {
                FirstDetection = os.time(),
                Detections = {}
            }
            
            -- –õ–æ–≥–∏—Ä—É–µ–º
            local log = string.format("[%s] –ß–ò–¢ –û–ë–ù–ê–†–£–ñ–ï–ù: %s - %s", 
                os.date("%H:%M:%S"), player.Name, detectionString)
            table.insert(self.DetectionLogs, log)
            print("üö® " .. log)
        end
        
        table.insert(self.ActiveCheaters[player].Detections, {
            Time = os.time(),
            Reason = detectionString
        })
        
        return true, detectionString
    end
    
    return false, nil
end

-- ============================================
-- 2. –°–ò–°–¢–ï–ú–ê –ñ–ê–õ–û–ë
-- ============================================

local ReportSystem = {
    PendingReports = {},
    ReportCooldown = 60, -- —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∂–∞–ª–æ–±–∞–º–∏
    LastReportTime = 0
}

-- –°–æ–∑–¥–∞–Ω–∏–µ –∂–∞–ª–æ–±—ã
function ReportSystem:CreateReport(targetPlayer, reason, evidence)
    local currentTime = os.time()
    
    -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞
    if currentTime - self.LastReportTime < self.ReportCooldown then
        local remaining = self.ReportCooldown - (currentTime - self.LastReportTime)
        return false, string.format("–ü–æ–¥–æ–∂–¥–∏—Ç–µ %d —Å–µ–∫—É–Ω–¥", remaining)
    end
    
    -- –°–æ–±–∏—Ä–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    local reportData = {
        Timestamp = currentTime,
        Reporter = LocalPlayer.Name,
        ReporterId = LocalPlayer.UserId,
        Target = targetPlayer.Name,
        TargetId = targetPlayer.UserId,
        Reason = reason or "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∏—Ç–æ–≤",
        Evidence = evidence or {},
        Game = {
            Name = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name,
            PlaceId = game.PlaceId,
            JobId = game.JobId
        }
    }
    
    -- –°–æ—Ö—Ä–∞–Ω—è–µ–º –∂–∞–ª–æ–±—É
    table.insert(self.PendingReports, reportData)
    self.LastReportTime = currentTime
    
    -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    StarterGui:SetCore("SendNotification", {
        Title = "‚úÖ –ñ–∞–ª–æ–±–∞ —Å–æ–∑–¥–∞–Ω–∞",
        Text = string.format("–ù–∞ –∏–≥—Ä–æ–∫–∞: %s\n–ü—Ä–∏—á–∏–Ω–∞: %s", targetPlayer.Name, reason or "–ß–∏—Ç—ã"),
        Duration = 5,
        Icon = "rbxassetid://4483345998"
    })
    
    -- –õ–æ–≥–∏—Ä—É–µ–º
    print(string.format("[–ñ–ê–õ–û–ë–ê] –°–æ–∑–¥–∞–Ω–∞ –∂–∞–ª–æ–±–∞ –Ω–∞ %s: %s", targetPlayer.Name, reason or "–ß–∏—Ç—ã"))
    
    return true, "–ñ–∞–ª–æ–±–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞"
end

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∂–∞–ª–æ–±–∞ –Ω–∞ —á–∏—Ç–µ—Ä–∞
function ReportSystem:AutoReportCheater(player, cheatReason)
    if not player or player == LocalPlayer then return end
    
    local evidence = {}
    
    -- –°–æ–±–∏—Ä–∞–µ–º –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞
    if CheatDetector.PlayerHistory[player] then
        evidence.Detections = CheatDetector.PlayerHistory[player]
    end
    
    -- –°–æ–∑–¥–∞–µ–º –∂–∞–ª–æ–±—É
    local success, message = self:CreateReport(
        player,
        string.format("–û–±–Ω–∞—Ä—É–∂–µ–Ω —á–∏—Ç–µ—Ä: %s", cheatReason),
        evidence
    )
    
    return success, message
end

-- ============================================
-- 3. GUI –°–ò–°–¢–ï–ú–ê
-- ============================================

-- –°–æ–∑–¥–∞–Ω–∏–µ GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "GGH_AntiCheat_GUI"
ScreenGui.DisplayOrder = 999999
ScreenGui.IgnoreGuiInset = true
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ GUI
local function SafeParentGUI()
    local success, result = pcall(function()
        local targetParent = LocalPlayer:FindFirstChild("PlayerGui") or game:GetService("CoreGui")
        ScreenGui.Parent = targetParent
        return true
    end)
    
    if not success then
        warn("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å GUI:", result)
        return false
    end
    
    return true
end

SafeParentGUI()

-- –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ
local MainWindow = Instance.new("Frame")
MainWindow.Name = "MainWindow"
MainWindow.Size = UDim2.new(0, 500, 0, 600)
MainWindow.Position = UDim2.new(0.5, -250, 0.5, -300)
MainWindow.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
MainWindow.BackgroundTransparency = 0.05
MainWindow.BorderSizePixel = 0
MainWindow.Visible = false
MainWindow.ZIndex = 100
MainWindow.Parent = ScreenGui

-- –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 15)
MainCorner.Parent = MainWindow

local MainStroke = Instance.new("UIStroke")
MainStroke.Color = Color3.fromRGB(80, 120, 200)
MainStroke.Thickness = 2
MainStroke.Transparency = 0.3
MainStroke.Parent = MainWindow

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 50)
TitleBar.BackgroundColor3 = Color3.fromRGB(25, 30, 45)
TitleBar.ZIndex = 101
TitleBar.Parent = MainWindow

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 15)
TitleCorner.Parent = TitleBar

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Text = "üõ°Ô∏è GGH ANTI-CHEAT v3.0"
TitleLabel.Size = UDim2.new(0.7, 0, 1, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextSize = 20
TitleLabel.ZIndex = 102
TitleLabel.Parent = TitleBar

-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
local CloseButton = Instance.new("TextButton")
CloseButton.Text = "‚úï"
CloseButton.Size = UDim2.new(0, 40, 0, 40)
CloseButton.Position = UDim2.new(1, -45, 0, 5)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 18
CloseButton.ZIndex = 102
CloseButton.Parent = TitleBar

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseButton

CloseButton.MouseButton1Click:Connect(function()
    MainWindow.Visible = false
end)

-- –í–∫–ª–∞–¥–∫–∏
local TabContainer = Instance.new("Frame")
TabContainer.Size = UDim2.new(1, -20, 0, 40)
TabContainer.Position = UDim2.new(0, 10, 0, 55)
TabContainer.BackgroundTransparency = 1
TabContainer.ZIndex = 101
TabContainer.Parent = MainWindow

local Tabs = {
    Players = {Button = nil, Frame = nil},
    Detections = {Button = nil, Frame = nil},
    Reports = {Button = nil, Frame = nil},
    Settings = {Button = nil, Frame = nil}
}

local activeTab = "Players"

-- –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–∫–ª–∞–¥–∫–∏
local function CreateTab(name, displayName, position)
    local tabButton = Instance.new("TextButton")
    tabButton.Text = displayName
    tabButton.Size = UDim2.new(0.22, 0, 1, 0)
    tabButton.Position = position
    tabButton.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
    tabButton.TextColor3 = Color3.new(1, 1, 1)
    tabButton.Font = Enum.Font.Gotham
    tabButton.TextSize = 14
    tabButton.ZIndex = 102
    tabButton.Parent = TabContainer
    
    local tabCorner = Instance.new("UICorner")
    tabCorner.CornerRadius = UDim.new(0, 8)
    tabCorner.Parent = tabButton
    
    -- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∫–ª–∞–¥–∫–∏
    local tabFrame = Instance.new("Frame")
    tabFrame.Size = UDim2.new(1, -20, 1, -110)
    tabFrame.Position = UDim2.new(0, 10, 0, 100)
    tabFrame.BackgroundTransparency = 1
    tabFrame.Visible = false
    tabFrame.ZIndex = 101
    tabFrame.Parent = MainWindow
    
    tabButton.MouseButton1Click:Connect(function()
        -- –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
        for tabName, tabData in pairs(Tabs) do
            if tabData.Frame then
                tabData.Frame.Visible = false
                if tabData.Button then
                    tabData.Button.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
                end
            end
        end
        
        -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é
        activeTab = name
        tabFrame.Visible = true
        tabButton.BackgroundColor3 = Color3.fromRGB(60, 80, 160)
    end)
    
    return tabButton, tabFrame
end

-- –°–æ–∑–¥–∞–µ–º –≤–∫–ª–∞–¥–∫–∏
local tabWidth = 0.22
local tabSpacing = 0.01
Tabs.Players.Button, Tabs.Players.Frame = CreateTab("Players", "üë• –ò–≥—Ä–æ–∫–∏", UDim2.new(0, 0, 0, 0))
Tabs.Detections.Button, Tabs.Detections.Frame = CreateTab("Detections", "üö® –î–µ—Ç–µ–∫—Ü–∏–∏", UDim2.new(tabWidth + tabSpacing, 0, 0, 0))
Tabs.Reports.Button, Tabs.Reports.Frame = CreateTab("Reports", "üìã –ñ–∞–ª–æ–±—ã", UDim2.new((tabWidth + tabSpacing) * 2, 0, 0, 0))
Tabs.Settings.Button, Tabs.Settings.Frame = CreateTab("Settings", "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", UDim2.new((tabWidth + tabSpacing) * 3, 0, 0, 0))

-- –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –≤–∫–ª–∞–¥–∫—É
Tabs.Players.Button.BackgroundColor3 = Color3.fromRGB(60, 80, 160)
Tabs.Players.Frame.Visible = true

-- ============================================
-- 4. –°–û–î–ï–†–ñ–ò–ú–û–ï –í–ö–õ–ê–î–û–ö
-- ============================================

-- –í–∫–ª–∞–¥–∫–∞ "–ò–≥—Ä–æ–∫–∏"
local PlayersScrolling = Instance.new("ScrollingFrame")
PlayersScrolling.Size = UDim2.new(1, 0, 1, 0)
PlayersScrolling.BackgroundTransparency = 1
PlayersScrolling.BorderSizePixel = 0
PlayersScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
PlayersScrolling.ScrollBarThickness = 6
PlayersScrolling.ScrollBarImageColor3 = Color3.fromRGB(80, 100, 180)
PlayersScrolling.ZIndex = 102
PlayersScrolling.Parent = Tabs.Players.Frame

-- –í–∫–ª–∞–¥–∫–∞ "–î–µ—Ç–µ–∫—Ü–∏–∏"
local DetectionsLabel = Instance.new("TextLabel")
DetectionsLabel.Text = "–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:"
DetectionsLabel.Size = UDim2.new(1, 0, 0, 30)
DetectionsLabel.BackgroundTransparency = 1
DetectionsLabel.TextColor3 = Color3.new(1, 1, 1)
DetectionsLabel.Font = Enum.Font.GothamBold
DetectionsLabel.TextSize = 16
DetectionsLabel.ZIndex = 102
DetectionsLabel.Parent = Tabs.Detections.Frame

local DetectionsScrolling = Instance.new("ScrollingFrame")
DetectionsScrolling.Size = UDim2.new(1, 0, 1, -40)
DetectionsScrolling.Position = UDim2.new(0, 0, 0, 40)
DetectionsScrolling.BackgroundTransparency = 1
DetectionsScrolling.BorderSizePixel = 0
DetectionsScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
DetectionsScrolling.ScrollBarThickness = 6
DetectionsScrolling.ScrollBarImageColor3 = Color3.fromRGB(80, 100, 180)
DetectionsScrolling.ZIndex = 102
DetectionsScrolling.Parent = Tabs.Detections.Frame

-- –í–∫–ª–∞–¥–∫–∞ "–ñ–∞–ª–æ–±—ã"
local ReportInput = Instance.new("TextBox")
ReportInput.PlaceholderText = "–ò–º—è –∏–≥—Ä–æ–∫–∞ –¥–ª—è –∂–∞–ª–æ–±—ã..."
ReportInput.Size = UDim2.new(0.7, 0, 0, 40)
ReportInput.Position = UDim2.new(0.05, 0, 0.1, 0)
ReportInput.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
ReportInput.TextColor3 = Color3.new(1, 1, 1)
ReportInput.Font = Enum.Font.Gotham
ReportInput.TextSize = 14
ReportInput.ZIndex = 102
ReportInput.Parent = Tabs.Reports.Frame

local ReportReason = Instance.new("TextBox")
ReportReason.PlaceholderText = "–ü—Ä–∏—á–∏–Ω–∞ –∂–∞–ª–æ–±—ã..."
ReportReason.Size = UDim2.new(0.7, 0, 0, 80)
ReportReason.Position = UDim2.new(0.05, 0, 0.2, 0)
ReportReason.BackgroundColor3 = Color3.fromRGB(40, 45, 60)
ReportReason.TextColor3 = Color3.new(1, 1, 1)
ReportReason.Font = Enum.Font.Gotham
ReportReason.TextSize = 14
ReportReason.TextWrapped = true
ReportReason.ZIndex = 102
ReportReason.Parent = Tabs.Reports.Frame

local SubmitReportButton = Instance.new("TextButton")
SubmitReportButton.Text = "üì§ –û–¢–ü–†–ê–í–ò–¢–¨ –ñ–ê–õ–û–ë–£"
SubmitReportButton.Size = UDim2.new(0.7, 0, 0, 50)
SubmitReportButton.Position = UDim2.new(0.05, 0, 0.5, 0)
SubmitReportButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
SubmitReportButton.TextColor3 = Color3.new(1, 1, 1)
SubmitReportButton.Font = Enum.Font.GothamBold
SubmitReportButton.TextSize = 16
SubmitReportButton.ZIndex = 102
SubmitReportButton.Parent = Tabs.Reports.Frame

local ReportCorner = Instance.new("UICorner")
ReportCorner.CornerRadius = UDim.new(0, 10)
ReportCorner.Parent = SubmitReportButton

SubmitReportButton.MouseButton1Click:Connect(function()
    local targetName = ReportInput.Text:gsub("%s+", "")
    local reason = ReportReason.Text
    
    if #targetName < 2 then
        StarterGui:SetCore("SendNotification", {
            Title = "‚ùå –û—à–∏–±–∫–∞",
            Text = "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏–≥—Ä–æ–∫–∞",
            Duration = 3,
            Icon = "rbxassetid://4483345998"
        })
        return
    end
    
    -- –ò—â–µ–º –∏–≥—Ä–æ–∫–∞
    local targetPlayer
    for _, player in pairs(Players:GetPlayers()) do
        if player.Name:lower():find(targetName:lower(), 1, true) then
            targetPlayer = player
            break
        end
    end
    
    if not targetPlayer then
        StarterGui:SetCore("SendNotification", {
            Title = "‚ùå –û—à–∏–±–∫–∞",
            Text = "–ò–≥—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω",
            Duration = 3,
            Icon = "rbxassetid://4483345998"
        })
        return
    end
    
    if targetPlayer == LocalPlayer then
        StarterGui:SetCore("SendNotification", {
            Title = "‚ùå –û—à–∏–±–∫–∞",
            Text = "–ù–µ–ª—å–∑—è –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ–±—è",
            Duration = 3,
            Icon = "rbxassetid://4483345998"
        })
        return
    end
    
    -- –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∂–∞–ª–æ–±—É
    local success, message = ReportSystem:CreateReport(targetPlayer, reason)
    
    if success then
        ReportInput.Text = ""
        ReportReason.Text = ""
    end
end)

-- –í–∫–ª–∞–¥–∫–∞ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
local SpeedSliderLabel = Instance.new("TextLabel")
SpeedSliderLabel.Text = "–ü–æ—Ä–æ–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏: 250 studs/—Å–µ–∫"
SpeedSliderLabel.Size = UDim2.new(1, 0, 0, 30)
SpeedSliderLabel.BackgroundTransparency = 1
SpeedSliderLabel.TextColor3 = Color3.new(1, 1, 1)
SpeedSliderLabel.Font = Enum.Font.Gotham
SpeedSliderLabel.TextSize = 14
SpeedSliderLabel.ZIndex = 102
SpeedSliderLabel.Parent = Tabs.Settings.Frame

local SpeedSlider = Instance.new("Slider")
SpeedSlider.Size = UDim2.new(0.9, 0, 0, 20)
SpeedSlider.Position = UDim2.new(0.05, 0, 0.1, 0)
SpeedSlider.BackgroundColor3 = Color3.fromRGB(60, 70, 90)
SpeedSlider.ZIndex = 102
SpeedSlider.MinValue = 100
SpeedSlider.MaxValue = 1000
SpeedSlider.Value = 250
SpeedSlider.Parent = Tabs.Settings.Frame

SpeedSlider.Changed:Connect(function()
    CheatDetector.Settings.SpeedThreshold = SpeedSlider.Value
    SpeedSliderLabel.Text = string.format("–ü–æ—Ä–æ–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏: %d studs/—Å–µ–∫", SpeedSlider.Value)
end)

-- ============================================
-- 5. –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
-- ============================================

local function UpdatePlayersList()
    PlayersScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
    
    -- –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    for _, child in pairs(PlayersScrolling:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    local yOffset = 0
    local cheaterCount = 0
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–≥—Ä–æ–∫–∞
            local isCheating, cheatReason = CheatDetector:CheckPlayer(player)
            
            -- –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
            local playerFrame = Instance.new("Frame")
            playerFrame.Size = UDim2.new(1, -10, 0, 60)
            playerFrame.Position = UDim2.new(0, 5, 0, yOffset)
            playerFrame.BackgroundColor3 = isCheating and Color3.fromRGB(60, 30, 30) or Color3.fromRGB(40, 45, 60)
            playerFrame.ZIndex = 103
            playerFrame.Parent = PlayersScrolling
            
            local frameCorner = Instance.new("UICorner")
            frameCorner.CornerRadius = UDim.new(0, 8)
            frameCorner.Parent = playerFrame
            
            -- –ò–º—è –∏–≥—Ä–æ–∫–∞
            local nameLabel = Instance.new("TextLabel")
            nameLabel.Text = player.Name
            nameLabel.Size = UDim2.new(0.6, 0, 0.5, 0)
            nameLabel.Position = UDim2.new(0.05, 0, 0, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.TextColor3 = Color3.new(1, 1, 1)
            nameLabel.Font = Enum.Font.GothamBold
            nameLabel.TextSize = 16
            nameLabel.TextXAlignment = Enum.TextXAlignment.Left
            nameLabel.ZIndex = 104
            nameLabel.Parent = playerFrame
            
            -- –°—Ç–∞—Ç—É—Å
            local statusLabel = Instance.new("TextLabel")
            statusLabel.Text = isCheating and "üö® –ß–ò–¢–ï–†" or "‚úÖ –ß–ò–°–¢–´–ô"
            statusLabel.Size = UDim2.new(0.6, 0, 0.5, 0)
            statusLabel.Position = UDim2.new(0.05, 0, 0.5, 0)
            statusLabel.BackgroundTransparency = 1
            statusLabel.TextColor3 = isCheating and Color3.fromRGB(255, 100, 100) or Color3.fromRGB(100, 255, 100)
            statusLabel.Font = Enum.Font.Gotham
            statusLabel.TextSize = 14
            statusLabel.TextXAlignment = Enum.TextXAlignment.Left
            statusLabel.ZIndex = 104
            statusLabel.Parent = playerFrame
            
            -- –ö–Ω–æ–ø–∫–∞ –∂–∞–ª–æ–±—ã
            local reportButton = Instance.new("TextButton")
            reportButton.Text = "üìã –ñ–ê–õ–û–ë–ê"
            reportButton.Size = UDim2.new(0.3, 0, 0.7, 0)
            reportButton.Position = UDim2.new(0.65, 0, 0.15, 0)
            reportButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
            reportButton.TextColor3 = Color3.new(1, 1, 1)
            reportButton.Font = Enum.Font.GothamBold
            reportButton.TextSize = 12
            reportButton.ZIndex = 104
            reportButton.Parent = playerFrame
            
            local buttonCorner = Instance.new("UICorner")
            buttonCorner.CornerRadius = UDim.new(0, 6)
            buttonCorner.Parent = reportButton
            
            reportButton.MouseButton1Click:Connect(function()
                if isCheating then
                    ReportSystem:AutoReportCheater(player, cheatReason)
                else
                    ReportSystem:CreateReport(player, "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ")
                end
            end)
            
            yOffset = yOffset + 65
            if isCheating then cheaterCount = cheaterCount + 1 end
        end
    end
    
    PlayersScrolling.CanvasSize = UDim2.new(0, 0, 0, yOffset)
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
    TitleLabel.Text = string.format("üõ°Ô∏è GGH ANTI-CHEAT [%d/%d]", cheaterCount, #Players:GetPlayers() - 1)
end

local function UpdateDetectionsList()
    DetectionsScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
    
    for _, child in pairs(DetectionsScrolling:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    local yOffset = 0
    
    for i = #CheatDetector.DetectionLogs, 1, -1 do
        local log = CheatDetector.DetectionLogs[i]
        
        local logFrame = Instance.new("Frame")
        logFrame.Size = UDim2.new(1, -10, 0, 40)
        logFrame.Position = UDim2.new(0, 5, 0, yOffset)
        logFrame.BackgroundColor3 = Color3.fromRGB(40, 30, 30)
        logFrame.ZIndex = 103
        logFrame.Parent = DetectionsScrolling
        
        local logLabel = Instance.new("TextLabel")
        logLabel.Text = log
        logLabel.Size = UDim2.new(1, 0, 1, 0)
        logLabel.BackgroundTransparency = 1
        logLabel.TextColor3 = Color3.fromRGB(255, 150, 150)
        logLabel.Font = Enum.Font.Gotham
        logLabel.TextSize = 12
        logLabel.TextWrapped = true
        logLabel.TextXAlignment = Enum.TextXAlignment.Left
        logLabel.ZIndex = 104
        logLabel.Parent = logFrame
        
        yOffset = yOffset + 45
    end
    
    DetectionsScrolling.CanvasSize = UDim2.new(0, 0, 0, yOffset)
end

-- ============================================
-- 6. –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò –ó–ê–ü–£–°–ö
-- ============================================

-- –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ GUI
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed then
        if input.KeyCode == Enum.KeyCode.K then
            MainWindow.Visible = not MainWindow.Visible
            if MainWindow.Visible then
                UpdatePlayersList()
                UpdateDetectionsList()
            end
        elseif input.KeyCode == Enum.KeyCode.Escape and MainWindow.Visible then
            MainWindow.Visible = false
        end
    end
end)

-- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ GUI
local dragging = false
local dragStart, frameStart

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        frameStart = MainWindow.Position
    end
end)

TitleBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        MainWindow.Position = UDim2.new(
            frameStart.X.Scale,
            frameStart.X.Offset + delta.X,
            frameStart.Y.Scale,
            frameStart.Y.Offset + delta.Y
        )
    end
end)

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
RunService.Heartbeat:Connect(function()
    if MainWindow.Visible then
        UpdatePlayersList()
        UpdateDetectionsList()
    end
end)

-- –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
task.spawn(function()
    while true do
        for _, player in pairs(Players:GetPlayers()) do
            CheatDetector:CheckPlayer(player)
        end
        task.wait(CheatDetector.Settings.CheckInterval)
    end
end)

-- –ù–∞—á–∞–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
task.wait(1)
StarterGui:SetCore("SendNotification", {
    Title = "‚úÖ GGH Anti-Cheat –∑–∞–≥—Ä—É–∂–µ–Ω",
    Text = "–ù–∞–∂–º–∏—Ç–µ K –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é\n–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞ –≤–æ –≤—Å–µ—Ö –∏–≥—Ä–∞—Ö",
    Duration = 5,
    Icon = "rbxassetid://4483345998"
})

print("=======================================")
print("üöÄ GGH UNIVERSAL CHEAT DETECTOR v3.0")
print("‚úÖ –°–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞")
print("üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –í–ö–õ–Æ–ß–ï–ù")
print("üìä –î–µ—Ç–µ–∫—Ü–∏—è: –ê–ö–¢–ò–í–ù–ê")
print("üìã –ñ–∞–ª–æ–±—ã: –ì–û–¢–û–í–´")
print("üéÆ GUI: –ì–û–¢–û–í (K –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è)")
print("=======================================")
